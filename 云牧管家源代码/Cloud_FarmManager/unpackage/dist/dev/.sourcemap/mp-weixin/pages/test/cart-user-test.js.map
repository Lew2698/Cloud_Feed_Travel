{"version":3,"file":"cart-user-test.js","sources":["pages/test/cart-user-test.vue","../../../../HBuilderX.4.57.2025032507/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdGVzdC9jYXJ0LXVzZXItdGVzdC52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"test-container\">\r\n\t\t<view class=\"test-header\">\r\n\t\t\t<text class=\"test-title\">购物车用户隔离测试</text>\r\n\t\t</view>\r\n\r\n\t\t<!-- 当前用户信息 -->\r\n\t\t<view class=\"user-info-section\">\r\n\t\t\t<view class=\"section-title\">当前用户信息</view>\r\n\t\t\t<view class=\"info-item\">\r\n\t\t\t\t<text class=\"info-label\">用户ID:</text>\r\n\t\t\t\t<text class=\"info-value\">{{ currentUserInfo.userId }}</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"info-item\">\r\n\t\t\t\t<text class=\"info-label\">存储Key:</text>\r\n\t\t\t\t<text class=\"info-value\">{{ currentUserInfo.cartKey }}</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"info-item\">\r\n\t\t\t\t<text class=\"info-label\">购物车商品数:</text>\r\n\t\t\t\t<text class=\"info-value\">{{ currentUserInfo.itemCount }}</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 用户切换测试 -->\r\n\t\t<view class=\"user-switch-section\">\r\n\t\t\t<view class=\"section-title\">用户切换测试</view>\r\n\t\t\t<button class=\"test-button\" @click=\"loginAsUser1\">登录为用户1</button>\r\n\t\t\t<button class=\"test-button\" @click=\"loginAsUser2\">登录为用户2</button>\r\n\t\t\t<button class=\"test-button\" @click=\"loginAsGuest\">切换为游客</button>\r\n\t\t</view>\r\n\r\n\t\t<!-- 购物车操作测试 -->\r\n\t\t<view class=\"cart-test-section\">\r\n\t\t\t<view class=\"section-title\">购物车操作测试</view>\r\n\t\t\t<button class=\"test-button\" @click=\"addTestProduct\">添加测试商品</button>\r\n\t\t\t<button class=\"test-button\" @click=\"clearCurrentCart\">清空当前购物车</button>\r\n\t\t\t<button class=\"test-button\" @click=\"viewCartItems\">查看购物车商品</button>\r\n\t\t</view>\r\n\r\n\t\t<!-- 购物车商品列表 -->\r\n\t\t<view class=\"cart-items-section\" v-if=\"cartItems.length > 0\">\r\n\t\t\t<view class=\"section-title\">当前购物车商品</view>\r\n\t\t\t<view class=\"cart-item\" v-for=\"(item, index) in cartItems\" :key=\"index\">\r\n\t\t\t\t<text class=\"item-name\">{{ item.name }}</text>\r\n\t\t\t\t<text class=\"item-quantity\">数量: {{ item.quantity }}</text>\r\n\t\t\t\t<text class=\"item-price\">¥{{ item.price }}</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 测试结果 -->\r\n\t\t<view class=\"test-result-section\">\r\n\t\t\t<view class=\"section-title\">测试结果</view>\r\n\t\t\t<text class=\"test-result\">{{ testResult }}</text>\r\n\t\t</view>\r\n\r\n\t\t<!-- 返回按钮 -->\r\n\t\t<view class=\"back-section\">\r\n\t\t\t<button class=\"back-button\" @click=\"goBack\">返回</button>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, getCurrentInstance } from 'vue'\r\n\r\nconst { proxy } = getCurrentInstance()\r\n\r\nconst currentUserInfo = ref({\r\n\tuserId: '',\r\n\tcartKey: '',\r\n\titemCount: 0\r\n})\r\n\r\nconst cartItems = ref([])\r\nconst testResult = ref('等待测试...')\r\n\r\n// 更新用户信息显示\r\nconst updateUserInfo = () => {\r\n\tconst userInfo = proxy.$cartStore.getCurrentUserInfo()\r\n\tcurrentUserInfo.value = userInfo\r\n\tcartItems.value = proxy.$cartStore.getCartItems()\r\n}\r\n\r\n// 模拟登录为用户1\r\nconst loginAsUser1 = () => {\r\n\tuni.setStorageSync('userInfo', {\r\n\t\tuserId: 'user_001',\r\n\t\tusername: 'testuser1',\r\n\t\tnickname: '测试用户1'\r\n\t})\r\n\tuni.setStorageSync('userToken', 'token_user_001')\r\n\t\r\n\tproxy.$cartStore.switchUser()\r\n\tupdateUserInfo()\r\n\ttestResult.value = '已切换到用户1'\r\n}\r\n\r\n// 模拟登录为用户2\r\nconst loginAsUser2 = () => {\r\n\tuni.setStorageSync('userInfo', {\r\n\t\tuserId: 'user_002',\r\n\t\tusername: 'testuser2',\r\n\t\tnickname: '测试用户2'\r\n\t})\r\n\tuni.setStorageSync('userToken', 'token_user_002')\r\n\t\r\n\tproxy.$cartStore.switchUser()\r\n\tupdateUserInfo()\r\n\ttestResult.value = '已切换到用户2'\r\n}\r\n\r\n// 切换为游客\r\nconst loginAsGuest = () => {\r\n\tuni.removeStorageSync('userInfo')\r\n\tuni.removeStorageSync('userToken')\r\n\t\r\n\tproxy.$cartStore.switchUser()\r\n\tupdateUserInfo()\r\n\ttestResult.value = '已切换到游客模式'\r\n}\r\n\r\n// 添加测试商品\r\nconst addTestProduct = () => {\r\n\tconst testProduct = {\r\n\t\tid: Date.now(),\r\n\t\tname: `测试商品_${Date.now()}`,\r\n\t\tprice: Math.floor(Math.random() * 100) + 10,\r\n\t\timage: '/static/static2/3944.jpg_wh860.jpg'\r\n\t}\r\n\t\r\n\tconst success = proxy.$cartStore.addToCart(testProduct, 1)\r\n\tif (success) {\r\n\t\tupdateUserInfo()\r\n\t\ttestResult.value = `已添加商品: ${testProduct.name}`\r\n\t}\r\n}\r\n\r\n// 清空当前购物车\r\nconst clearCurrentCart = () => {\r\n\tproxy.$cartStore.clearCart()\r\n\tupdateUserInfo()\r\n\ttestResult.value = '已清空当前用户的购物车'\r\n}\r\n\r\n// 查看购物车商品\r\nconst viewCartItems = () => {\r\n\tupdateUserInfo()\r\n\ttestResult.value = `当前购物车有 ${cartItems.value.length} 件商品`\r\n}\r\n\r\n// 返回\r\nconst goBack = () => {\r\n\tuni.navigateBack()\r\n}\r\n\r\nonMounted(() => {\r\n\tupdateUserInfo()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.test-container {\r\n\tpadding: 30rpx;\r\n\tbackground-color: #f5f5f5;\r\n\tmin-height: 100vh;\r\n}\r\n\r\n.test-header {\r\n\ttext-align: center;\r\n\tmargin-bottom: 40rpx;\r\n}\r\n\r\n.test-title {\r\n\tfont-size: 36rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #333;\r\n}\r\n\r\n.user-info-section,\r\n.user-switch-section,\r\n.cart-test-section,\r\n.cart-items-section,\r\n.test-result-section,\r\n.back-section {\r\n\tbackground-color: white;\r\n\tborder-radius: 16rpx;\r\n\tpadding: 30rpx;\r\n\tmargin-bottom: 30rpx;\r\n}\r\n\r\n.section-title {\r\n\tfont-size: 32rpx;\r\n\tfont-weight: 600;\r\n\tcolor: #333;\r\n\tmargin-bottom: 20rpx;\r\n\tborder-bottom: 2rpx solid #eee;\r\n\tpadding-bottom: 10rpx;\r\n}\r\n\r\n.info-item {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tpadding: 10rpx 0;\r\n\tborder-bottom: 1rpx solid #f5f5f5;\r\n}\r\n\r\n.info-label {\r\n\tfont-size: 28rpx;\r\n\tcolor: #666;\r\n}\r\n\r\n.info-value {\r\n\tfont-size: 28rpx;\r\n\tcolor: #333;\r\n\tfont-weight: 500;\r\n}\r\n\r\n.test-button {\r\n\twidth: 100%;\r\n\theight: 80rpx;\r\n\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n\tcolor: white;\r\n\tborder: none;\r\n\tborder-radius: 10rpx;\r\n\tfont-size: 28rpx;\r\n\tmargin-bottom: 20rpx;\r\n}\r\n\r\n.cart-item {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tpadding: 20rpx;\r\n\tbackground-color: #f9f9f9;\r\n\tborder-radius: 10rpx;\r\n\tmargin-bottom: 10rpx;\r\n}\r\n\r\n.item-name {\r\n\tfont-size: 28rpx;\r\n\tcolor: #333;\r\n\tflex: 1;\r\n}\r\n\r\n.item-quantity {\r\n\tfont-size: 24rpx;\r\n\tcolor: #666;\r\n\tmargin: 0 20rpx;\r\n}\r\n\r\n.item-price {\r\n\tfont-size: 28rpx;\r\n\tcolor: #e74c3c;\r\n\tfont-weight: 600;\r\n}\r\n\r\n.test-result {\r\n\tfont-size: 28rpx;\r\n\tcolor: #333;\r\n\tline-height: 1.6;\r\n\tpadding: 20rpx;\r\n\tbackground-color: #f0f8ff;\r\n\tborder-radius: 10rpx;\r\n\tborder-left: 4rpx solid #667eea;\r\n}\r\n\r\n.back-button {\r\n\twidth: 100%;\r\n\theight: 80rpx;\r\n\tbackground-color: #95a5a6;\r\n\tcolor: white;\r\n\tborder: none;\r\n\tborder-radius: 10rpx;\r\n\tfont-size: 28rpx;\r\n}\r\n</style> ","import MiniProgramPage from 'D:/前端开发/云养丝路/云牧管家源代码/Cloud_FarmManager/pages/test/cart-user-test.vue'\nwx.createPage(MiniProgramPage)"],"names":["getCurrentInstance","ref","uni","onMounted"],"mappings":";;;;;AAiEA,UAAM,EAAE,MAAO,IAAGA,iCAAoB;AAEtC,UAAM,kBAAkBC,cAAAA,IAAI;AAAA,MAC3B,QAAQ;AAAA,MACR,SAAS;AAAA,MACT,WAAW;AAAA,IACZ,CAAC;AAED,UAAM,YAAYA,cAAG,IAAC,EAAE;AACxB,UAAM,aAAaA,cAAG,IAAC,SAAS;AAGhC,UAAM,iBAAiB,MAAM;AAC5B,YAAM,WAAW,MAAM,WAAW,mBAAoB;AACtD,sBAAgB,QAAQ;AACxB,gBAAU,QAAQ,MAAM,WAAW,aAAc;AAAA,IAClD;AAGA,UAAM,eAAe,MAAM;AAC1BC,oBAAG,MAAC,eAAe,YAAY;AAAA,QAC9B,QAAQ;AAAA,QACR,UAAU;AAAA,QACV,UAAU;AAAA,MACZ,CAAE;AACDA,0BAAI,eAAe,aAAa,gBAAgB;AAEhD,YAAM,WAAW,WAAY;AAC7B,qBAAgB;AAChB,iBAAW,QAAQ;AAAA,IACpB;AAGA,UAAM,eAAe,MAAM;AAC1BA,oBAAG,MAAC,eAAe,YAAY;AAAA,QAC9B,QAAQ;AAAA,QACR,UAAU;AAAA,QACV,UAAU;AAAA,MACZ,CAAE;AACDA,0BAAI,eAAe,aAAa,gBAAgB;AAEhD,YAAM,WAAW,WAAY;AAC7B,qBAAgB;AAChB,iBAAW,QAAQ;AAAA,IACpB;AAGA,UAAM,eAAe,MAAM;AAC1BA,oBAAG,MAAC,kBAAkB,UAAU;AAChCA,oBAAG,MAAC,kBAAkB,WAAW;AAEjC,YAAM,WAAW,WAAY;AAC7B,qBAAgB;AAChB,iBAAW,QAAQ;AAAA,IACpB;AAGA,UAAM,iBAAiB,MAAM;AAC5B,YAAM,cAAc;AAAA,QACnB,IAAI,KAAK,IAAK;AAAA,QACd,MAAM,QAAQ,KAAK,IAAK,CAAA;AAAA,QACxB,OAAO,KAAK,MAAM,KAAK,OAAQ,IAAG,GAAG,IAAI;AAAA,QACzC,OAAO;AAAA,MACP;AAED,YAAM,UAAU,MAAM,WAAW,UAAU,aAAa,CAAC;AACzD,UAAI,SAAS;AACZ,uBAAgB;AAChB,mBAAW,QAAQ,UAAU,YAAY,IAAI;AAAA,MAC7C;AAAA,IACF;AAGA,UAAM,mBAAmB,MAAM;AAC9B,YAAM,WAAW,UAAW;AAC5B,qBAAgB;AAChB,iBAAW,QAAQ;AAAA,IACpB;AAGA,UAAM,gBAAgB,MAAM;AAC3B,qBAAgB;AAChB,iBAAW,QAAQ,UAAU,UAAU,MAAM,MAAM;AAAA,IACpD;AAGA,UAAM,SAAS,MAAM;AACpBA,oBAAAA,MAAI,aAAc;AAAA,IACnB;AAEAC,kBAAAA,UAAU,MAAM;AACf,qBAAgB;AAAA,IACjB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5JD,GAAG,WAAW,eAAe;"}