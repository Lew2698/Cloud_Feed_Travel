{"version":3,"file":"image-migration-test.js","sources":["pages/test/image-migration-test.vue","../../../../HBuilderX.4.57.2025032507/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdGVzdC9pbWFnZS1taWdyYXRpb24tdGVzdC52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"page-container\">\r\n\t\t<view class=\"header\">\r\n\t\t\t<text class=\"title\">图片云端迁移管理</text>\r\n\t\t\t<text class=\"subtitle\">将本地图片迁移到云存储，便于维护</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 迁移状态 -->\r\n\t\t<view class=\"status-card\">\r\n\t\t\t<view class=\"status-header\">\r\n\t\t\t\t<text class=\"status-title\">迁移状态</text>\r\n\t\t\t\t<button class=\"refresh-btn\" @click=\"checkMigrationStatus\">刷新</button>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"status-content\">\r\n\t\t\t\t<text class=\"status-text\">需要迁移的图片: {{ migrationInfo.totalImages }}</text>\r\n\t\t\t\t<text class=\"status-text\">已上传图片: {{ uploadedImages.length }}</text>\r\n\t\t\t\t<text class=\"status-text\">迁移进度: {{ migrationProgress }}%</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 图片上传区域 -->\r\n\t\t<view class=\"upload-section\">\r\n\t\t\t<text class=\"section-title\">图片上传</text>\r\n\t\t\t<view class=\"upload-grid\">\r\n\t\t\t\t<view class=\"upload-item\" @click=\"uploadImages('products')\">\r\n\t\t\t\t\t<image src=\"/static/icons/shopping icon/image.svg\" class=\"upload-icon\"></image>\r\n\t\t\t\t\t<text class=\"upload-text\">商品图片</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"upload-item\" @click=\"uploadImages('farms')\">\r\n\t\t\t\t\t<image src=\"/static/icons/shopping icon/image.svg\" class=\"upload-icon\"></image>\r\n\t\t\t\t\t<text class=\"upload-text\">农场图片</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"upload-item\" @click=\"uploadImages('avatars')\">\r\n\t\t\t\t\t<image src=\"/static/icons/shopping icon/image.svg\" class=\"upload-icon\"></image>\r\n\t\t\t\t\t<text class=\"upload-text\">头像图片</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 操作按钮 -->\r\n\t\t<view class=\"action-section\">\r\n\t\t\t<button class=\"action-btn upload-btn\" @click=\"batchUploadImages\" :disabled=\"loading\">\r\n\t\t\t\t{{ loading ? '上传中...' : '批量上传图片' }}\r\n\t\t\t</button>\r\n\t\t\t<button class=\"action-btn migrate-btn\" @click=\"updateImagePaths\" :disabled=\"loading || uploadedImages.length === 0\">\r\n\t\t\t\t更新商品图片路径\r\n\t\t\t</button>\r\n\t\t\t<button class=\"action-btn test-btn\" @click=\"testImageAccess\" :disabled=\"loading\">\r\n\t\t\t\t测试图片访问\r\n\t\t\t</button>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 已上传图片列表 -->\r\n\t\t<view class=\"uploaded-images\" v-if=\"uploadedImages.length > 0\">\r\n\t\t\t<text class=\"section-title\">已上传图片 ({{ uploadedImages.length }})</text>\r\n\t\t\t<view class=\"image-grid\">\r\n\t\t\t\t<view class=\"image-item\" v-for=\"(image, index) in uploadedImages\" :key=\"index\">\r\n\t\t\t\t\t<image :src=\"image.url\" class=\"preview-image\" mode=\"aspectFill\" @click=\"previewImage(image.url)\"></image>\r\n\t\t\t\t\t<view class=\"image-info\">\r\n\t\t\t\t\t\t<text class=\"image-name\">{{ image.name }}</text>\r\n\t\t\t\t\t\t<text class=\"image-path\">{{ image.fileID }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"image-actions\">\r\n\t\t\t\t\t\t<button class=\"delete-btn\" @click=\"deleteImage(image, index)\">删除</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 迁移映射表 -->\r\n\t\t<view class=\"mapping-section\" v-if=\"Object.keys(imageMapping).length > 0\">\r\n\t\t\t<text class=\"section-title\">图片路径映射表</text>\r\n\t\t\t<view class=\"mapping-list\">\r\n\t\t\t\t<view class=\"mapping-item\" v-for=\"(cloudPath, localPath) in imageMapping\" :key=\"localPath\">\r\n\t\t\t\t\t<view class=\"mapping-row\">\r\n\t\t\t\t\t\t<text class=\"local-path\">{{ localPath }}</text>\r\n\t\t\t\t\t\t<text class=\"arrow\">→</text>\r\n\t\t\t\t\t\t<text class=\"cloud-path\">{{ cloudPath }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 测试结果 -->\r\n\t\t<view class=\"test-results\" v-if=\"testResults.length > 0\">\r\n\t\t\t<text class=\"section-title\">测试结果</text>\r\n\t\t\t<view class=\"result-item\" v-for=\"(result, index) in testResults\" :key=\"index\">\r\n\t\t\t\t<view class=\"result-header\">\r\n\t\t\t\t\t<text class=\"result-title\">{{ result.title }}</text>\r\n\t\t\t\t\t<text class=\"result-status\" :class=\"result.success ? 'success' : 'error'\">\r\n\t\t\t\t\t\t{{ result.success ? '成功' : '失败' }}\r\n\t\t\t\t\t</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<text class=\"result-message\">{{ result.message }}</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 日志输出 -->\r\n\t\t<view class=\"logs\" v-if=\"logs.length > 0\">\r\n\t\t\t<text class=\"logs-title\">操作日志</text>\r\n\t\t\t<view class=\"log-item\" v-for=\"(log, index) in logs\" :key=\"index\">\r\n\t\t\t\t<text class=\"log-time\">{{ log.time }}</text>\r\n\t\t\t\t<text class=\"log-message\" :class=\"log.type\">{{ log.message }}</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport { \r\n\tuploadImage, \r\n\tuploadProductImage, \r\n\tdeleteImage, \r\n\tgetImageMigrationMapping,\r\n\tupdateProductImages,\r\n\tgetTempFileURLs,\r\n\tpreviewImages\r\n} from '@/api/imageService.js'\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tloading: false,\r\n\t\t\tmigrationInfo: {\r\n\t\t\t\ttotalImages: 0,\r\n\t\t\t\timageMapping: {}\r\n\t\t\t},\r\n\t\t\tuploadedImages: [], // 已上传的图片列表\r\n\t\t\timageMapping: {}, // 图片路径映射\r\n\t\t\ttestResults: [],\r\n\t\t\tlogs: []\r\n\t\t}\r\n\t},\r\n\t\r\n\tcomputed: {\r\n\t\tmigrationProgress() {\r\n\t\t\tif (this.migrationInfo.totalImages === 0) return 0\r\n\t\t\treturn Math.round((this.uploadedImages.length / this.migrationInfo.totalImages) * 100)\r\n\t\t}\r\n\t},\r\n\t\r\n\tonLoad() {\r\n\t\tthis.addLog('页面加载完成', 'info')\r\n\t\tthis.checkMigrationStatus()\r\n\t},\r\n\t\r\n\tmethods: {\r\n\t\t// 添加日志\r\n\t\taddLog(message, type = 'info') {\r\n\t\t\tconst now = new Date()\r\n\t\t\tconst time = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`\r\n\t\t\t\r\n\t\t\tthis.logs.unshift({\r\n\t\t\t\ttime,\r\n\t\t\t\tmessage,\r\n\t\t\t\ttype\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\t// 限制日志数量\r\n\t\t\tif (this.logs.length > 50) {\r\n\t\t\t\tthis.logs = this.logs.slice(0, 50)\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 检查迁移状态\r\n\t\tasync checkMigrationStatus() {\r\n\t\t\ttry {\r\n\t\t\t\tthis.addLog('检查迁移状态...', 'info')\r\n\t\t\t\t\r\n\t\t\t\tconst result = await getImageMigrationMapping()\r\n\t\t\t\t\r\n\t\t\t\tif (result.code === 200) {\r\n\t\t\t\t\tthis.migrationInfo.totalImages = result.data.totalImages\r\n\t\t\t\t\tthis.migrationInfo.imageMapping = result.data.imageMapping\r\n\t\t\t\t\tthis.imageMapping = result.data.imageMapping\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.addLog(`发现 ${result.data.totalImages} 个需要迁移的图片`, 'success')\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.addLog(`检查迁移状态失败: ${result.message}`, 'error')\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.addLog(`检查迁移状态异常: ${error.message}`, 'error')\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 上传图片\r\n\t\tasync uploadImages(category) {\r\n\t\t\ttry {\r\n\t\t\t\tthis.addLog(`开始上传${category}图片...`, 'info')\r\n\t\t\t\t\r\n\t\t\t\tconst result = await uploadImage({\r\n\t\t\t\t\tcategory,\r\n\t\t\t\t\tcount: 9,\r\n\t\t\t\t\tsizeType: ['compressed']\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tif (result.code === 200) {\r\n\t\t\t\t\tconst successImages = result.data.results.filter(r => r.success)\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (let img of successImages) {\r\n\t\t\t\t\t\t// 获取临时访问URL用于预览\r\n\t\t\t\t\t\tconst urlResult = await getTempFileURLs([img.fileID])\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.uploadedImages.push({\r\n\t\t\t\t\t\t\tfileID: img.fileID,\r\n\t\t\t\t\t\t\tcloudPath: img.cloudPath,\r\n\t\t\t\t\t\t\turl: urlResult.data[0].tempFileURL,\r\n\t\t\t\t\t\t\tname: `${category}_image_${Date.now()}`,\r\n\t\t\t\t\t\t\tcategory\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.addLog(`上传成功 ${successImages.length} 张图片`, 'success')\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: `上传成功${successImages.length}张`,\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.addLog(`上传图片失败: ${result.message}`, 'error')\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.addLog(`上传图片异常: ${error.message}`, 'error')\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 批量上传图片\r\n\t\tasync batchUploadImages() {\r\n\t\t\tif (this.loading) return\r\n\t\t\t\r\n\t\t\tthis.loading = true\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tthis.addLog('开始批量上传图片...', 'info')\r\n\t\t\t\t\r\n\t\t\t\t// 按分类上传\r\n\t\t\t\tconst categories = ['products', 'farms', 'avatars']\r\n\t\t\t\t\r\n\t\t\t\tfor (let category of categories) {\r\n\t\t\t\t\tawait this.uploadImages(category)\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.addLog('批量上传完成', 'success')\r\n\t\t\t\t\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.addLog(`批量上传失败: ${error.message}`, 'error')\r\n\t\t\t} finally {\r\n\t\t\t\tthis.loading = false\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 更新商品图片路径\r\n\t\tasync updateImagePaths() {\r\n\t\t\tif (this.loading) return\r\n\t\t\t\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: '确认更新',\r\n\t\t\t\tcontent: '确定要更新数据库中的图片路径吗？此操作将修改所有商品数据。',\r\n\t\t\t\tsuccess: async (res) => {\r\n\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\tawait this.performUpdateImagePaths()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// 执行更新图片路径\r\n\t\tasync performUpdateImagePaths() {\r\n\t\t\tthis.loading = true\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tthis.addLog('开始更新商品图片路径...', 'info')\r\n\t\t\t\t\r\n\t\t\t\t// 构建实际的图片映射（将已上传的图片映射到原路径）\r\n\t\t\t\tconst actualMapping = {}\r\n\t\t\t\t\r\n\t\t\t\t// 这里需要手动建立映射关系\r\n\t\t\t\t// 在实际使用中，可以通过文件名或其他方式来匹配\r\n\t\t\t\t// 简化示例：使用uploadedImages中的fileID\r\n\t\t\t\tthis.uploadedImages.forEach((img, index) => {\r\n\t\t\t\t\tconst localPaths = Object.keys(this.imageMapping)\r\n\t\t\t\t\tif (localPaths[index]) {\r\n\t\t\t\t\t\tactualMapping[localPaths[index]] = img.fileID\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tconst result = await updateProductImages(actualMapping)\r\n\t\t\t\t\r\n\t\t\t\tif (result.code === 200) {\r\n\t\t\t\t\tthis.addLog(`成功更新 ${result.data.updatedProducts} 个商品的图片路径`, 'success')\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '路径更新成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.addLog(`更新图片路径失败: ${result.message}`, 'error')\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '更新失败',\r\n\t\t\t\t\t\ticon: 'error'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.addLog(`更新图片路径异常: ${error.message}`, 'error')\r\n\t\t\t} finally {\r\n\t\t\t\tthis.loading = false\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 测试图片访问\r\n\t\tasync testImageAccess() {\r\n\t\t\tif (this.loading) return\r\n\t\t\t\r\n\t\t\tthis.loading = true\r\n\t\t\tthis.testResults = []\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tthis.addLog('开始测试图片访问...', 'info')\r\n\t\t\t\t\r\n\t\t\t\t// 测试已上传图片的访问性\r\n\t\t\t\tfor (let i = 0; i < Math.min(this.uploadedImages.length, 3); i++) {\r\n\t\t\t\t\tconst image = this.uploadedImages[i]\r\n\t\t\t\t\t\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t// 获取临时URL\r\n\t\t\t\t\t\tconst urlResult = await getTempFileURLs([image.fileID])\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.testResults.push({\r\n\t\t\t\t\t\t\ttitle: `图片访问测试 ${i + 1}`,\r\n\t\t\t\t\t\t\tsuccess: urlResult.code === 200,\r\n\t\t\t\t\t\t\tmessage: urlResult.code === 200 ? \r\n\t\t\t\t\t\t\t\t`图片访问正常: ${image.name}` : \r\n\t\t\t\t\t\t\t\t`图片访问失败: ${urlResult.message}`\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tthis.testResults.push({\r\n\t\t\t\t\t\t\ttitle: `图片访问测试 ${i + 1}`,\r\n\t\t\t\t\t\t\tsuccess: false,\r\n\t\t\t\t\t\t\tmessage: `测试失败: ${error.message}`\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.addLog('图片访问测试完成', 'success')\r\n\t\t\t\t\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.addLog(`测试图片访问异常: ${error.message}`, 'error')\r\n\t\t\t} finally {\r\n\t\t\t\tthis.loading = false\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 删除图片\r\n\t\tasync deleteImage(image, index) {\r\n\t\t\tuni.showModal({\r\n\t\t\t\ttitle: '确认删除',\r\n\t\t\t\tcontent: `确定要删除图片 ${image.name} 吗？`,\r\n\t\t\t\tsuccess: async (res) => {\r\n\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tconst result = await deleteImage(image.fileID)\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (result.code === 200) {\r\n\t\t\t\t\t\t\t\tthis.uploadedImages.splice(index, 1)\r\n\t\t\t\t\t\t\t\tthis.addLog(`删除图片成功: ${image.name}`, 'success')\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '删除成功',\r\n\t\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.addLog(`删除图片失败: ${result.message}`, 'error')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t\tthis.addLog(`删除图片异常: ${error.message}`, 'error')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// 预览图片\r\n\t\tpreviewImage(url) {\r\n\t\t\tpreviewImages([url])\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t@import '@/uni.scss';\r\n\t\r\n\t.page-container {\r\n\t\tpadding: 30rpx;\r\n\t\tbackground-color: $color-secondary;\r\n\t\tmin-height: 100vh;\r\n\t}\r\n\t\r\n\t.header {\r\n\t\ttext-align: center;\r\n\t\tmargin-bottom: 40rpx;\r\n\t}\r\n\t\r\n\t.title {\r\n\t\tfont-size: 36rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: $color-dark;\r\n\t\tdisplay: block;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\t\r\n\t.subtitle {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t\tdisplay: block;\r\n\t}\r\n\t\r\n\t.status-card {\r\n\t\tbackground-color: white;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\r\n\t}\r\n\t\r\n\t.status-header {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.status-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: $color-dark;\r\n\t}\r\n\t\r\n\t.refresh-btn {\r\n\t\tbackground-color: $color-primary;\r\n\t\tcolor: white;\r\n\t\tborder: none;\r\n\t\tborder-radius: 8rpx;\r\n\t\tpadding: 8rpx 16rpx;\r\n\t\tfont-size: 24rpx;\r\n\t}\r\n\t\r\n\t.status-content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 10rpx;\r\n\t}\r\n\t\r\n\t.status-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #666;\r\n\t}\r\n\t\r\n\t.upload-section {\r\n\t\tbackground-color: white;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\r\n\t}\r\n\t\r\n\t.section-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: $color-dark;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tdisplay: block;\r\n\t}\r\n\t\r\n\t.upload-grid {\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: repeat(3, 1fr);\r\n\t\tgap: 20rpx;\r\n\t}\r\n\t\r\n\t.upload-item {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tpadding: 30rpx;\r\n\t\tborder: 2rpx dashed #ddd;\r\n\t\tborder-radius: 12rpx;\r\n\t\tbackground-color: #f9f9f9;\r\n\t}\r\n\t\r\n\t.upload-icon {\r\n\t\twidth: 60rpx;\r\n\t\theight: 60rpx;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\t\r\n\t.upload-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #666;\r\n\t}\r\n\t\r\n\t.action-section {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tgap: 20rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\t\r\n\t.action-btn {\r\n\t\tpadding: 24rpx;\r\n\t\tborder-radius: 12rpx;\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: 600;\r\n\t\tborder: none;\r\n\t\tcolor: white;\r\n\t}\r\n\t\r\n\t.upload-btn {\r\n\t\tbackground: linear-gradient(135deg, #667eea, #764ba2);\r\n\t}\r\n\t\r\n\t.migrate-btn {\r\n\t\tbackground: linear-gradient(135deg, $color-primary, $color-highlight);\r\n\t}\r\n\t\r\n\t.test-btn {\r\n\t\tbackground: linear-gradient(135deg, #5352ed, #3742fa);\r\n\t}\r\n\t\r\n\t.action-btn[disabled] {\r\n\t\topacity: 0.6;\r\n\t}\r\n\t\r\n\t.uploaded-images {\r\n\t\tbackground-color: white;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\r\n\t}\r\n\t\r\n\t.image-grid {\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: repeat(2, 1fr);\r\n\t\tgap: 20rpx;\r\n\t}\r\n\t\r\n\t.image-item {\r\n\t\tborder: 1px solid #eee;\r\n\t\tborder-radius: 12rpx;\r\n\t\toverflow: hidden;\r\n\t}\r\n\t\r\n\t.preview-image {\r\n\t\twidth: 100%;\r\n\t\theight: 200rpx;\r\n\t\tobject-fit: cover;\r\n\t}\r\n\t\r\n\t.image-info {\r\n\t\tpadding: 15rpx;\r\n\t}\r\n\t\r\n\t.image-name {\r\n\t\tfont-size: 26rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: $color-dark;\r\n\t\tdisplay: block;\r\n\t\tmargin-bottom: 5rpx;\r\n\t}\r\n\t\r\n\t.image-path {\r\n\t\tfont-size: 20rpx;\r\n\t\tcolor: #999;\r\n\t\tword-break: break-all;\r\n\t}\r\n\t\r\n\t.image-actions {\r\n\t\tpadding: 10rpx 15rpx;\r\n\t\tborder-top: 1px solid #eee;\r\n\t}\r\n\t\r\n\t.delete-btn {\r\n\t\tbackground-color: #ff4757;\r\n\t\tcolor: white;\r\n\t\tborder: none;\r\n\t\tborder-radius: 6rpx;\r\n\t\tpadding: 8rpx 16rpx;\r\n\t\tfont-size: 22rpx;\r\n\t}\r\n\t\r\n\t.mapping-section {\r\n\t\tbackground-color: white;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\r\n\t}\r\n\t\r\n\t.mapping-list {\r\n\t\tmax-height: 400rpx;\r\n\t\toverflow-y: auto;\r\n\t}\r\n\t\r\n\t.mapping-item {\r\n\t\tborder-bottom: 1px solid #f0f0f0;\r\n\t\tpadding: 15rpx 0;\r\n\t}\r\n\t\r\n\t.mapping-row {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tgap: 10rpx;\r\n\t}\r\n\t\r\n\t.local-path {\r\n\t\tflex: 1;\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #666;\r\n\t\tword-break: break-all;\r\n\t}\r\n\t\r\n\t.arrow {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: $color-primary;\r\n\t}\r\n\t\r\n\t.cloud-path {\r\n\t\tflex: 1;\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: $color-primary;\r\n\t\tword-break: break-all;\r\n\t}\r\n\t\r\n\t.test-results {\r\n\t\tbackground-color: white;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\r\n\t}\r\n\t\r\n\t.result-item {\r\n\t\tborder: 1px solid #eee;\r\n\t\tborder-radius: 8rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\t\r\n\t.result-header {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\t\r\n\t.result-title {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: $color-dark;\r\n\t}\r\n\t\r\n\t.result-status {\r\n\t\tfont-size: 24rpx;\r\n\t\tpadding: 4rpx 12rpx;\r\n\t\tborder-radius: 12rpx;\r\n\t\t\r\n\t\t&.success {\r\n\t\t\tbackground-color: #2ed573;\r\n\t\t\tcolor: white;\r\n\t\t}\r\n\t\t\r\n\t\t&.error {\r\n\t\t\tbackground-color: #ff4757;\r\n\t\t\tcolor: white;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.result-message {\r\n\t\tfont-size: 26rpx;\r\n\t\tcolor: #666;\r\n\t}\r\n\t\r\n\t.logs {\r\n\t\tbackground-color: white;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\r\n\t}\r\n\t\r\n\t.logs-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tfont-weight: 600;\r\n\t\tcolor: $color-dark;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tdisplay: block;\r\n\t}\r\n\t\r\n\t.log-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: flex-start;\r\n\t\tpadding: 10rpx 0;\r\n\t\tborder-bottom: 1px solid #f0f0f0;\r\n\t}\r\n\t\r\n\t.log-item:last-child {\r\n\t\tborder-bottom: none;\r\n\t}\r\n\t\r\n\t.log-time {\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #999;\r\n\t\tmargin-right: 15rpx;\r\n\t\tmin-width: 80rpx;\r\n\t}\r\n\t\r\n\t.log-message {\r\n\t\tfont-size: 24rpx;\r\n\t\tflex: 1;\r\n\t\t\r\n\t\t&.info {\r\n\t\t\tcolor: #666;\r\n\t\t}\r\n\t\t\r\n\t\t&.success {\r\n\t\t\tcolor: #2ed573;\r\n\t\t}\r\n\t\t\r\n\t\t&.error {\r\n\t\t\tcolor: #ff4757;\r\n\t\t}\r\n\t}\r\n</style> ","import MiniProgramPage from 'D:/前端开发/云养丝路/云牧管家源代码/Cloud_FarmManager/pages/test/image-migration-test.vue'\nwx.createPage(MiniProgramPage)"],"names":["getImageMigrationMapping","uploadImage","getTempFileURLs","uni","updateProductImages","deleteImage","previewImages"],"mappings":";;;;AAuHA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,SAAS;AAAA,MACT,eAAe;AAAA,QACd,aAAa;AAAA,QACb,cAAc,CAAC;AAAA,MACf;AAAA,MACD,gBAAgB,CAAE;AAAA;AAAA,MAClB,cAAc,CAAE;AAAA;AAAA,MAChB,aAAa,CAAE;AAAA,MACf,MAAM,CAAC;AAAA,IACR;AAAA,EACA;AAAA,EAED,UAAU;AAAA,IACT,oBAAoB;AACnB,UAAI,KAAK,cAAc,gBAAgB;AAAG,eAAO;AACjD,aAAO,KAAK,MAAO,KAAK,eAAe,SAAS,KAAK,cAAc,cAAe,GAAG;AAAA,IACtF;AAAA,EACA;AAAA,EAED,SAAS;AACR,SAAK,OAAO,UAAU,MAAM;AAC5B,SAAK,qBAAqB;AAAA,EAC1B;AAAA,EAED,SAAS;AAAA;AAAA,IAER,OAAO,SAAS,OAAO,QAAQ;AAC9B,YAAM,MAAM,oBAAI,KAAK;AACrB,YAAM,OAAO,GAAG,IAAI,SAAU,EAAC,SAAQ,EAAG,SAAS,GAAG,GAAG,CAAC,IAAI,IAAI,WAAY,EAAC,SAAU,EAAC,SAAS,GAAG,GAAG,CAAC,IAAI,IAAI,WAAY,EAAC,SAAQ,EAAG,SAAS,GAAG,GAAG,CAAC;AAE1J,WAAK,KAAK,QAAQ;AAAA,QACjB;AAAA,QACA;AAAA,QACA;AAAA,OACA;AAGD,UAAI,KAAK,KAAK,SAAS,IAAI;AAC1B,aAAK,OAAO,KAAK,KAAK,MAAM,GAAG,EAAE;AAAA,MAClC;AAAA,IACA;AAAA;AAAA,IAGD,MAAM,uBAAuB;AAC5B,UAAI;AACH,aAAK,OAAO,aAAa,MAAM;AAE/B,cAAM,SAAS,MAAMA,0CAAyB;AAE9C,YAAI,OAAO,SAAS,KAAK;AACxB,eAAK,cAAc,cAAc,OAAO,KAAK;AAC7C,eAAK,cAAc,eAAe,OAAO,KAAK;AAC9C,eAAK,eAAe,OAAO,KAAK;AAEhC,eAAK,OAAO,MAAM,OAAO,KAAK,WAAW,aAAa,SAAS;AAAA,eACzD;AACN,eAAK,OAAO,aAAa,OAAO,OAAO,IAAI,OAAO;AAAA,QACnD;AAAA,MACC,SAAO,OAAO;AACf,aAAK,OAAO,aAAa,MAAM,OAAO,IAAI,OAAO;AAAA,MAClD;AAAA,IACA;AAAA;AAAA,IAGD,MAAM,aAAa,UAAU;AAC5B,UAAI;AACH,aAAK,OAAO,OAAO,QAAQ,SAAS,MAAM;AAE1C,cAAM,SAAS,MAAMC,6BAAY;AAAA,UAChC;AAAA,UACA,OAAO;AAAA,UACP,UAAU,CAAC,YAAY;AAAA,SACvB;AAED,YAAI,OAAO,SAAS,KAAK;AACxB,gBAAM,gBAAgB,OAAO,KAAK,QAAQ,OAAO,OAAK,EAAE,OAAO;AAE/D,mBAAS,OAAO,eAAe;AAE9B,kBAAM,YAAY,MAAMC,iBAAAA,gBAAgB,CAAC,IAAI,MAAM,CAAC;AAEpD,iBAAK,eAAe,KAAK;AAAA,cACxB,QAAQ,IAAI;AAAA,cACZ,WAAW,IAAI;AAAA,cACf,KAAK,UAAU,KAAK,CAAC,EAAE;AAAA,cACvB,MAAM,GAAG,QAAQ,UAAU,KAAK,IAAG,CAAE;AAAA,cACrC;AAAA,aACA;AAAA,UACF;AAEA,eAAK,OAAO,QAAQ,cAAc,MAAM,QAAQ,SAAS;AAEzDC,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO,OAAO,cAAc,MAAM;AAAA,YAClC,MAAM;AAAA,WACN;AAAA,eACK;AACN,eAAK,OAAO,WAAW,OAAO,OAAO,IAAI,OAAO;AAAA,QACjD;AAAA,MACC,SAAO,OAAO;AACf,aAAK,OAAO,WAAW,MAAM,OAAO,IAAI,OAAO;AAAA,MAChD;AAAA,IACA;AAAA;AAAA,IAGD,MAAM,oBAAoB;AACzB,UAAI,KAAK;AAAS;AAElB,WAAK,UAAU;AAEf,UAAI;AACH,aAAK,OAAO,eAAe,MAAM;AAGjC,cAAM,aAAa,CAAC,YAAY,SAAS,SAAS;AAElD,iBAAS,YAAY,YAAY;AAChC,gBAAM,KAAK,aAAa,QAAQ;AAAA,QACjC;AAEA,aAAK,OAAO,UAAU,SAAS;AAAA,MAE9B,SAAO,OAAO;AACf,aAAK,OAAO,WAAW,MAAM,OAAO,IAAI,OAAO;AAAA,MAChD,UAAU;AACT,aAAK,UAAU;AAAA,MAChB;AAAA,IACA;AAAA;AAAA,IAGD,MAAM,mBAAmB;AACxB,UAAI,KAAK;AAAS;AAElBA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,OAAO,QAAQ;AACvB,cAAI,IAAI,SAAS;AAChB,kBAAM,KAAK,wBAAwB;AAAA,UACpC;AAAA,QACD;AAAA,OACA;AAAA,IACD;AAAA;AAAA,IAGD,MAAM,0BAA0B;AAC/B,WAAK,UAAU;AAEf,UAAI;AACH,aAAK,OAAO,iBAAiB,MAAM;AAGnC,cAAM,gBAAgB,CAAC;AAKvB,aAAK,eAAe,QAAQ,CAAC,KAAK,UAAU;AAC3C,gBAAM,aAAa,OAAO,KAAK,KAAK,YAAY;AAChD,cAAI,WAAW,KAAK,GAAG;AACtB,0BAAc,WAAW,KAAK,CAAC,IAAI,IAAI;AAAA,UACxC;AAAA,SACA;AAED,cAAM,SAAS,MAAMC,iBAAmB,oBAAC,aAAa;AAEtD,YAAI,OAAO,SAAS,KAAK;AACxB,eAAK,OAAO,QAAQ,OAAO,KAAK,eAAe,aAAa,SAAS;AAErED,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,WACN;AAAA,eACK;AACN,eAAK,OAAO,aAAa,OAAO,OAAO,IAAI,OAAO;AAElDA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,WACN;AAAA,QACF;AAAA,MACC,SAAO,OAAO;AACf,aAAK,OAAO,aAAa,MAAM,OAAO,IAAI,OAAO;AAAA,MAClD,UAAU;AACT,aAAK,UAAU;AAAA,MAChB;AAAA,IACA;AAAA;AAAA,IAGD,MAAM,kBAAkB;AACvB,UAAI,KAAK;AAAS;AAElB,WAAK,UAAU;AACf,WAAK,cAAc,CAAC;AAEpB,UAAI;AACH,aAAK,OAAO,eAAe,MAAM;AAGjC,iBAAS,IAAI,GAAG,IAAI,KAAK,IAAI,KAAK,eAAe,QAAQ,CAAC,GAAG,KAAK;AACjE,gBAAM,QAAQ,KAAK,eAAe,CAAC;AAEnC,cAAI;AAEH,kBAAM,YAAY,MAAMD,iBAAAA,gBAAgB,CAAC,MAAM,MAAM,CAAC;AAEtD,iBAAK,YAAY,KAAK;AAAA,cACrB,OAAO,UAAU,IAAI,CAAC;AAAA,cACtB,SAAS,UAAU,SAAS;AAAA,cAC5B,SAAS,UAAU,SAAS,MAC3B,WAAW,MAAM,IAAI,KACrB,WAAW,UAAU,OAAO;AAAA,aAC7B;AAAA,UACA,SAAO,OAAO;AACf,iBAAK,YAAY,KAAK;AAAA,cACrB,OAAO,UAAU,IAAI,CAAC;AAAA,cACtB,SAAS;AAAA,cACT,SAAS,SAAS,MAAM,OAAO;AAAA,aAC/B;AAAA,UACF;AAAA,QACD;AAEA,aAAK,OAAO,YAAY,SAAS;AAAA,MAEhC,SAAO,OAAO;AACf,aAAK,OAAO,aAAa,MAAM,OAAO,IAAI,OAAO;AAAA,MAClD,UAAU;AACT,aAAK,UAAU;AAAA,MAChB;AAAA,IACA;AAAA;AAAA,IAGD,MAAM,YAAY,OAAO,OAAO;AAC/BC,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS,WAAW,MAAM,IAAI;AAAA,QAC9B,SAAS,OAAO,QAAQ;AACvB,cAAI,IAAI,SAAS;AAChB,gBAAI;AACH,oBAAM,SAAS,MAAME,6BAAY,MAAM,MAAM;AAE7C,kBAAI,OAAO,SAAS,KAAK;AACxB,qBAAK,eAAe,OAAO,OAAO,CAAC;AACnC,qBAAK,OAAO,WAAW,MAAM,IAAI,IAAI,SAAS;AAE9CF,8BAAAA,MAAI,UAAU;AAAA,kBACb,OAAO;AAAA,kBACP,MAAM;AAAA,iBACN;AAAA,qBACK;AACN,qBAAK,OAAO,WAAW,OAAO,OAAO,IAAI,OAAO;AAAA,cACjD;AAAA,YACC,SAAO,OAAO;AACf,mBAAK,OAAO,WAAW,MAAM,OAAO,IAAI,OAAO;AAAA,YAChD;AAAA,UACD;AAAA,QACD;AAAA,OACA;AAAA,IACD;AAAA;AAAA,IAGD,aAAa,KAAK;AACjBG,uBAAa,cAAC,CAAC,GAAG,CAAC;AAAA,IACpB;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClYA,GAAG,WAAW,eAAe;"}